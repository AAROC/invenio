## $Id$
## PERSONAL FEATURE - YOUR ALERTS

## This file is part of the CERN Document Server Software (CDSware).
## Copyright (C) 2002 CERN.
##
## The CDSware is free software; you can redistribute it and/or
## modify it under the terms of the GNU General Public License as
## published by the Free Software Foundation; either version 2 of the
## License, or (at your option) any later version.
##
## The CDSware is distributed in the hope that it will be useful, but
## WITHOUT ANY WARRANTY; without even the implied warranty of
## MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the GNU
## General Public License for more details.  
##
## You should have received a copy of the GNU General Public License
## along with CDSware; if not, write to the Free Software Foundation, Inc.,
## 59 Temple Place, Suite 330, Boston, MA 02111-1307, USA.

##read config variables
#include "config.wml"
#include "configbis.wml"

<protect>## $Id$ </protect>
<protect>## DO NOT EDIT THIS FILE!  IT WAS AUTOMATICALLY GENERATED FROM CDSware WML SOURCES.</protect>
"""PERSONAL FEATURES - YOUR ALERTS"""

## rest of the Python code goes below

## fill config variables:
pylibdir = "<LIBDIR>/python"

try:
    import sys
    import time
    import zlib
    import urllib
    import time
    sys.path.append('%s' % pylibdir)
    from cdsware.config import *
    from cdsware.webpage import page
    from cdsware import webalert
    from cdsware.user import getUid, create_user_infobox
    from mod_python import apache
except ImportError, e:
    print "Error: %s" % e
    import sys
    sys.exit(1)
    
### CALLABLE INTERFACE

def display(req, p="n"):
    uid = getUid(req)	
    return page("Display searches", webalert.perform_display(p,uid),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,
                "", "CDS Personalize, Display searches", "CDS, personalize", create_user_infobox(uid), "")


def input_alert(req, idq, name="", freq="week", notif="y", idb=0):
    uid = getUid(req)
    return page("Set a new alert", webalert.perform_input_alert("add", idq, name, freq, notif, idb,uid),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,
                "", "CDS Personalize, Set a new alert", "CDS, personalize", create_user_infobox(uid), "")

def modify_alert(req, idq, name="", freq="week", notif="y", idb=0):
    uid = getUid(req)
    return page("Modify alert settings", webalert.perform_input_alert("update", idq, name, freq, notif, idb,uid),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,                
                "", "CDS Personalize, Modify alert settings", "CDS, personalize", create_user_infobox(uid), "")


def list_alerts(req):
    uid = getUid(req)
    return page("Display alerts", webalert.perform_list_alerts(uid),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,                
                "", "CDS Personalize, Display alerts", "CDS, personalize", create_user_infobox(uid), "")

def add_alert(req, name, freq, notif, idb, bname, idq):
    uid = getUid(req)
    return page("Display alerts", webalert.perform_add_alert(name, freq, notif, idb, bname, idq,uid),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,                
                "", "CDS Personalize, Display alerts", "CDS, personalize", create_user_infobox(uid), "")

def update_alert(req, name, freq, notif, idb, bname, idq, old_idb):
    uid = getUid(req)
    return page("Display alerts", webalert.perform_update_alert(name, freq, notif, idb, bname, idq, old_idb,uid),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,                
                "", "CDS Personalize, Display alerts", "CDS, personalize", create_user_infobox(uid), "")

def remove_alert(req, name, idu, idq, idb):
    uid = getUid(req) 
    return page("Display alerts", webalert.perform_remove_alert(name, idu, idq, idb),
                """&gt; <a class="navtrail" href="%s/youraccount.py/display">Your Account</a> &gt;""" % weburl,                
                "", "CDS Personalize, Display alerts", "CDS, personalize", create_user_infobox(uid), "")


