CDS Invenio NATIVE LANGUAGE SUPPORT
===================================

Revision: $Id$

About
=====

This document describes the Native Language Support (NLS) in CDS Invenio.

Contents
========

1. Native Language Support information for administrators
2. Native Language Support information for translators
3. Native Language Support information for programmers
A. Introducing a new language

1. Native Language Support information for administrators
=========================================================

CDS Invenio is currently available in the following languages:

   bg = Bulgarian
   ca = Catalan 
   cs = Czech 
   de = German 
   el = Greek 
   en = English 
   es = Spanish 
   fr = French 
   it = Italian
   ja = Japanese
   no = Norwegian (Bokm√•l) 
   pl = Polish
   pt = Portuguese 
   ru = Russian 
   sk = Slovak 
   sv = Swedish
   uk = Ukrainian

If you are installing CDS Invenio and you want to enable/disable some
languages, please just follow the standard installation procedure as
described in the INSTALL file.  The default language of the
installation as well as the list of all user-seen languages can be
selected in the general config.wml file, see variables CDSLANG and
CDSLANGS.

(Please note that some runtime CDS Invenio daemons -- such as webcoll,
responsible for updating the collection cache, running every hour or
so -- may work twice as long when twice as many user-seen languages
are selected, because it creates collection cache page elements for
every user-seen language.  Therefore, if you have defined thousands of
collections and if you find the webcoll speed to be slow in your
setup, you may want to try to limit the list of selected languages.)

2. Native Language Support information for translators
======================================================

If you want to contibute a translation to CDS Invenio, then please follow
the procedure below:

  - Please check out the existence of po/LL.po file for your language,
    where LL stands for the ISO 639 language code (e.g. `el' for
    Greek).  If such a file exists, then this language is already
    supported, in which case you may want to review the existing
    translation (see below).  If the file does not exist yet, then you
    can create an empty one by copying the cds-invenio.pot template file
    into LL.po that you can review as described in the next item.
    (Please note that you would have to translate some dynamic
    elements that are currently not located in the PO file, see the
    appendix A below.)

  - Please edit LL.po to review existing translation.  The PO file
    format is a standard GNU gettext one and so you can take advantage
    of dedicated editing modes of programs such as GNU Emacs, KBabel,
    or poEdit to edit it.  Pay special attention to strings marked as
    fuzzy and untranslated.  (E.g. in the Emacs PO mode, press `f' and
    `u' to find them.)  Do not forget to remove fuzzy marks for
    reviewed translations.  (E.g. in the Emacs PO mode, press `TAB' to
    remove fuzzy status of a string.)

  - After you are done with translations, please validate your file to
    make sure it does not contain formatting errors.  (E.g. in the
    Emacs PO mode, press `V' to validate the file.)

  - If you have access to a test installation of CDS Invenio, you may want
    to see your modified PO file in action:

       $ cd po 
       $ emacs ja.po                      # edit Japanese translation
       $ make update-gmo
       $ make install
       $ sudo apachectl restart
       $ firefox http://your.site/?ln=ja  # check it out in context

    If you do not have access to a test installation, please
    contribute your PO file to the developers team (see the next step)
    and we shall install it on a test site and contact you so that you
    will be able to check your translation in the global context of
    the application.

    (Note to developers: note that ``make update-gmo'' command may be
    necessary to run before ``make'' if the latter fails, even if you
    are not touching translation business at all.  The reason being
    that the gmo files are not stored in CVS, while they are included
    in the distribution tarball.  So, if you are building from CVS,
    and you do not have them in your tree, you may get build errors in
    directories like modules/webhelp/web/admin saying things like ``No
    rule to make target `index.bg.html'''.  The solution is to run
    ``make update-gmo'' to produce the gmo files before running
    ``make''.  End of note to developers.)

  - Please contribute your translation by emailing the file to
    <cds.support@cern.ch>.  You help is greatly appreciated and will
    be properly credited in the CREDITS file.

See also the GNU gettext manual, especially the chapters 5, 6 and 11.
<http://www.gnu.org/software/gettext/manual/html_chapter/gettext_toc.html>

3. Native Language Support information for programmers
======================================================

CDS Invenio uses standard GNU gettext I18N and L12N philosophy.

In Python programs, all output strings should be made translatable via
_() convention:

   from messages import gettext_set_language
   [...]
   def square(x, ln=cdslang):
       _ = gettext_set_language(ln)
       print _("Hello there!")
       print _("The square of %s is %s.") % (x, x*x)

In WML source files, the convention is _()_:

   _(Search Help)_

Here are some tips for writing easily translatable phrases:  

  - Do not cut phrases into several pieces, and do not reuse
    standalone words.  If you have two similar phrases with some
    addition in the middle, rather define two sentences.  Remember
    that joining of sub-phrases may differ depending on what is being
    joined (e.g. gender).
 
       not: _("This") + _("record") + _("is not available.")
       not: _("This") + _("item") + _("is not available.")
 
       but: _("This record is not available.")
       but: _("This item is not available.")
 
  - Do not mix HTML presentation inside phrases. If you want to
    reserve space for markup, please use general %s placeholders:
 
       not: _("This is <b>bold</b>, isn't it?")
       but: _("This is %sbold%s, isn't it?")
 
  - Use unnamed %i or %s placeholder if you want to print variables in
    shorter sentences:
 
       not: _("There are %(x_number_of_baskets)s baskets.")
       yes: _("There are %i baskets.")
 
  - But, if you are printing more than one variable in a sentence, you
    should better name them, because in some languagues the correct
    grammar would be to invert the order.  Also, you may want to keep
    the names short and start them with ``x_'' to ease the variable
    recognition task for the translators.
  
       not: _("The value of %s is %s when %s.")
       but: _("The value of %(x_foo)s is %(x_bar)s when %(x_rains)s.")
 
  - Do not leave unnecessary things in messages, such as extraneous
    spaces or colons; put them rather in the business logic:
 
       not: _(" subject:")
       but: " " + _(" subject") + ":"
 
       not: _("Record #%d:")
       but: _("Record") + "#%d" % recID
 
The best is to follow existing message style as a model, as the
translators are accustomed to it.

Appendix A. Introducing a new language
======================================

If you are introducing a new language for the first time, then please
firstly create and edit the PO file as described above in Section 2.
This will make the largest portion of the translating work done, but
it is not fully enough, because we currently have also to translate
some dynamic elements that aren't located in PO files.

The development team can edit the respective files ourself, if the
translator sends over the following translations by email:
 
   - server name:
 
        Atlantis Institute of Fictive Science
 
   - field names, usually loaded from tabfill.sql.wml:
 
        any field
        title
        author
        abstract
        keyword
        report number
        subject  
        reference
        fulltext
        collection
        division
        year
        experiment
        record ID

   - miscellaneous terms loaded from tabfill.sql.wml:
 
        word similarity

   - collection names, usually loaded from democfgdata.sql.wml:
 
        Preprints
        Books
        Theses
        Reports
        Articles
        Pictures
        CERN Divisions
        CERN Experiments
        Theoretical Physics (TH)
        Experimental Physics (EP)
        Articles & Preprints
        Books & Reports
        Multimedia & Arts
        Poetry
 
   - miscellaneus terms loaded from democfgdata.sql.wml:

        journal impact factor
 
   - the right-hand-side portalbox:
 
        ABOUT THIS SITE
        Welcome to the demo site of the CDS Invenio, a free document server
        software coming from CERN. Please feel free to explore all the
        features of this demo site to the full.
        SEE ALSO
 
The development team will than edit various files (po/LINGUAS, config
files, sql files, plenty of Makefile files, etc) as needed.

The last phase of the initial introduction of the new language would
be to translate some short static HTML pages:
 
   - modules/webhelp/web/index.html.wml
   - modules/websearch/doc/index.html.wml

Thanks for helping to internationalize CDS Invenio.

       - CDS Development Group
         <cds.support@cern.ch>
         <http://cdsware.cern.ch/>




